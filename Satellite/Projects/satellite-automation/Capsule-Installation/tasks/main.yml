---
- name: main | RHV VM build
  import_tasks: rhv-vm-buid.yml
  when: rhvm_hostname is defined

- name: Main | Register to Satellite
  import_tasks: 1_rhsm.yml

- name: Main | Enable Repos
  import_tasks: 2_enable_repos.yml

- name: Main | Patch system
  import_tasks: 3_patch.yml

- name: Main | Configure Storage
  import_tasks: 4_configure_storage.yml

- name: Main | Install Satellite Capsule
  import_tasks: 5_install_package capsule.yml

- name: Main | Add host entry in /etc/hosts
  import_tasks: 6_dns_config.yml

- name: Main | Generate Capsule Install certificats
  import_tasks: 7_generate_cap_cert.yml
  when: satellite_CSR == 'true'

- name: Main | Generate capsule default certificates
  import_tasks: 7_gen_cap_default_cert.yml
  when: satellite_CSR != "true"

- name: Main | Install Satellite Capsule server
  import_tasks: 8_install_capsule.yml
